<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cascade Bruins Volleyball â€” Dinner & Tournament Sign-Up</title>
  <style>
    :root {
      --crimson:#7a1f2a; --crimson-2:#a2313e; --gray:#6b7280;
      --bg:#0f1216; --panel:#11161d; --ink:#f2f3f5; --muted:#aeb3bd;
      --ok:#89e6b8; --warn:#ffe08a; --bad:#ff8a8a;
      --radius:18px; --shadow:0 14px 40px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{margin:0;background:radial-gradient(1000px 600px at -10% -10%, #171b23, var(--bg));
      color:var(--ink);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    header{padding:28px 18px 6px;text-align:center}
    h1{margin:0;font-size:28px}
    .brand{display:flex;align-items:center;justify-content:center;gap:12px;margin-bottom:4px}
    .crest img{height:54px;width:auto;display:block;filter:drop-shadow(0 2px 8px rgba(0,0,0,.35))}
    p.sub{margin:6px 0 0;color:var(--muted)}
    main{display:grid;grid-template-columns:1.2fr .8fr;gap:22px;max-width:1100px;margin:26px auto;padding:0 18px}
    @media (max-width:900px){main{grid-template-columns:1fr}}
    .card{background:linear-gradient(180deg,var(--panel),#0b1017);border:1px solid rgba(255,255,255,.06);
      border-radius:var(--radius);box-shadow:var(--shadow)}
    .card h2{margin:0;padding:18px;border-bottom:1px solid rgba(255,255,255,.06);font-size:18px}
    .list{padding:8px 10px 10px}
    .date{display:flex;align-items:center;justify-content:space-between;gap:10px;margin:10px;padding:12px 14px;
      border-radius:14px;background:#0c1118;border:1px solid rgba(255,255,255,.08)}
    .date .meta{display:flex;flex-direction:column}
    .date .when{font-weight:700}
    .taken{opacity:.9;border-color:#1e2631;background:linear-gradient(180deg,#0b0f15,#0a0d11)}
    .taken .who{color:var(--muted)} .taken .btn{display:none}
    .btn{cursor:pointer;border:1px solid rgba(255,255,255,.12);background:linear-gradient(180deg,var(--crimson-2),var(--crimson));
      color:#fff;padding:9px 12px;border-radius:10px}
    .btn:hover{filter:brightness(1.06)} .btn:disabled{opacity:.55;cursor:not-allowed}
    form{padding:14px 18px 20px}
    label{display:block;margin:10px 0 4px;color:var(--muted);font-size:13px}
    input,textarea,select{width:100%;padding:11px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.09);
      background:#0a1219;color:var(--ink);outline:none}
    input:focus,textarea:focus,select:focus{border-color:var(--crimson-2);box-shadow:0 0 0 2px rgba(162,49,62,.28)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .help{font-size:12px;color:var(--muted)} .ok{color:var(--ok)} .err{color:var(--bad)}
    footer{max-width:1100px;margin:18px auto;padding:0 18px 30px;color:var(--muted);font-size:12px;text-align:center}
    table{width:100%;border-collapse:collapse} th,td{padding:10px 12px;border-bottom:1px solid rgba(255,255,255,.08);text-align:left}
    th{color:#cfd5dc;font-weight:600}
    .banner{max-width:1100px;margin:10px auto 0;padding:0 18px}
    .banner>div{background:linear-gradient(180deg,rgba(122,31,42,.12),rgba(122,31,42,.08));
      border:1px solid rgba(255,255,255,.12);color:#f2f3f5;padding:12px 14px;border-radius:12px;font-size:14px}
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="crest"><img src="./assets/chs-logo.jpeg" alt="Cascade Bruins logo"></div>
      <h1>Cascade Bruins Volleyball â€” Dinner & Tournament Sign-Up</h1>
    </div>
    <p class="sub">One volunteer per date to bring dinner/snacks. Home games + tournaments.</p>
  </header>

  <!-- Drinks reminder -->
  <div class="banner">
    <div><strong>Note on drinks:</strong> Drinks are <em>not required</em>. If you do bring them,
      please stick to <strong>water or sports drinks</strong> â€” <strong>no energy drinks or caffeinated beverages</strong>.</div>
  </div>

  <main>
    <section class="card">
      <h2>Open Dates</h2>
      <div class="list" id="dates"></div>
    </section>

    <section class="card">
      <h2>Volunteer Details</h2>
      <form id="signupForm">
        <label for="gameDate">Select Date</label>
        <select id="gameDate" required></select>
        <div class="row">
          <div><label for="name">Your Name</label><input id="name" required /></div>
          <div><label for="email">Email</label><input id="email" type="email" required /></div>
        </div>
        <label for="phone">Phone (optional)</label><input id="phone" />
        <label for="notes">Notes (optional)</label><textarea id="notes"></textarea>
        <button class="btn" type="submit">Reserve Date</button>
        <span id="msg" class="help"></span>
      </form>
    </section>

    <section class="card" style="grid-column:1/-1">
      <h2>Current Signups</h2>
      <div style="padding:14px 18px 20px">
        <table id="roster">
          <thead><tr><th>Date</th><th>Volunteer</th><th>Contact</th></tr></thead>
          <tbody></tbody>
        </table>
        <p class="help" id="rosterEmpty" style="display:none">No signups yet â€” be the first! ðŸŽ‰</p>
      </div>
    </section>
  </main>

  <footer>Cascade Bruins â€¢ Simple signup page powered by Google Sheets.</footer>

  <script>
    // === Your Apps Script Web App URL ===
    const GAS_URL = "https://script.google.com/macros/s/AKfycby5lMn1XaW98B6_bSXUFQ0i1Vlu3bmfw_EQFnwvB17klQSR0K_I9ktnwd2sc0ZGj2Xi/exec";

    // All home games + tournaments (2025)
    const GAMES = [
      { id:"2025-09-09", label:"Tue Sept 9 â€” HOME vs Marysvilleâ€“Pilchuck" },
      { id:"2025-09-13", label:"Sat Sept 13 â€” VARSITY TOURNAMENT (Everett HS)" },
      { id:"2025-09-20", label:"Sat Sept 20 â€” VARSITY/C-TEAM TOURNAMENT (Glacier Peak & Jackson HS)" },
      { id:"2025-09-22", label:"Mon Sept 22 â€” HOME vs Mariner" },
      { id:"2025-09-24", label:"Wed Sept 24 â€” HOME vs Kamiak" },
      { id:"2025-10-01", label:"Wed Oct 1 â€” HOME vs Mountlake Terrace" },
      { id:"2025-10-07", label:"Tue Oct 7 â€” HOME vs Lake Stevens" },
      { id:"2025-10-13", label:"Mon Oct 13 â€” HOME vs Arlington â€¢ Dig for the Cure" },
      { id:"2025-10-20", label:"Mon Oct 20 â€” HOME vs Everett â€¢ Spikefest" },
      { id:"2025-10-28", label:"Tue Oct 28 â€” HOME vs Glacier Peak" },
      { id:"2025-10-30", label:"Thu Oct 30 â€” HOME vs Jackson â€¢ Senior Night" }
    ];
    const LABELS = Object.fromEntries(GAMES.map(g => [g.id, g.label]));

    const $dates=document.getElementById('dates'), $select=document.getElementById('gameDate'),
          $form=document.getElementById('signupForm'), $msg=document.getElementById('msg'),
          $rosterBody=document.querySelector('#roster tbody'), $rosterEmpty=document.getElementById('rosterEmpty');

    function option(label,value,disabled=false){const o=document.createElement('option');o.textContent=label;o.value=value;o.disabled=disabled;return o;}
    function dateRow(game,taken){
      const row=document.createElement('div');row.className='date'+(taken?' taken':'');
      const left=document.createElement('div');left.className='meta';
      const when=document.createElement('div');when.className='when';when.textContent=game.label;
      const who=document.createElement('div');who.className='who help';
      if(taken){const contact=[taken.email||'',taken.phone?`(${taken.phone})`:''].filter(Boolean).join(' ');
        who.innerHTML=`Reserved by <strong>${taken.name}</strong> â€” ${contact}`;}
      else{who.textContent='Open â€” 1 slot';}
      const right=document.createElement('div');
      const btn=document.createElement('button');btn.className='btn';btn.textContent=taken?'Full':'Sign Up';btn.disabled=!!taken;
      btn.onclick=()=>{$select.value=game.id;document.getElementById('name').focus();window.scrollTo({top:0,behavior:'smooth'});};
      left.appendChild(when);left.appendChild(who);right.appendChild(btn);
      row.appendChild(left);row.appendChild(right);return row;
    }
    function renderDates(listing){
      $dates.innerHTML='';$select.innerHTML='';$select.appendChild(option('Choose a dateâ€¦','',true));
      GAMES.forEach(g=>{const taken=listing[g.id]||null;$dates.appendChild(dateRow(g,taken));$select.appendChild(option(g.label,g.id,!!taken));});
    }
    function renderRoster(listing){
      const taken=Object.entries(listing).filter(([id])=>LABELS[id])
        .map(([id,v])=>({id,label:LABELS[id],...v})).sort((a,b)=>a.id.localeCompare(b.id));
      $rosterBody.innerHTML='';
      if(!taken.length){$rosterEmpty.style.display='block';return;} $rosterEmpty.style.display='none';
      taken.forEach(r=>{const contact=[r.email||'',r.phone?`(${r.phone})`:''].filter(Boolean).join(' ');
        const tr=document.createElement('tr');tr.innerHTML=`<td>${r.label}</td><td>${r.name}</td><td>${contact}</td>`;$rosterBody.appendChild(tr);});
    }

    async function fetchListing(){const r=await fetch(GAS_URL+'?action=list');if(!r.ok)throw new Error('Failed to load');return r.json();}
    async function submitSignup(payload){
      const r=await fetch(GAS_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
      if(!r.ok)throw new Error('Failed to submit');return r.json();
    }

    (async function(){
      try{const listing=await fetchListing();renderDates(listing);renderRoster(listing);}catch(e){renderDates({});renderRoster({});}
      $form.addEventListener('submit',async e=>{
        e.preventDefault();$msg.textContent='';
        const id=$select.value,name=document.getElementById('name').value.trim(),
              email=document.getElementById('email').value.trim(),
              phone=document.getElementById('phone').value.trim(),
              notes=document.getElementById('notes').value.trim();
        if(!id||!name||!email){$msg.textContent='Fill all required fields';return;}
        const btn=$form.querySelector('button[type=submit]');btn.disabled=true;
        try{const res=await submitSignup({id,name,email,phone,notes});
          if(res&&res.ok){$msg.textContent='Saved! Confirmation email sent.';$msg.className='help ok';
            const listing2=await fetchListing();renderDates(listing2);renderRoster(listing2);
            $form.reset();$select.selectedIndex=0;}
          else{throw new Error(res&&res.error?res.error:'Unknown error');}}
        catch(err){$msg.textContent=err.message||'Error';$msg.className='help err';}
        finally{btn.disabled=false;}
      });
    })();
  </script>
</body>
</html>
